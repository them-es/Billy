import{getElement as e,store as t}from"@wordpress/interactivity";const __=wp.i18n.__;t("billy",{actions:{exportTable:()=>{var t;const{ref:l}=e(),r=null!==(t=l.value)&&void 0!==t?t:"xlsx";let n=__("Billy Table","billy");globalDataBilly.postTitle&&(n=globalDataBilly.postTitle);const a=document.querySelector('[id^="billy-"] table');let o=document.createElement("tr");if(o.appendChild(document.createElement("td")),a.insertBefore(o,a.firstChild),globalDataBilly.postDate){let e=document.createElement("tr");const t=document.createElement("td");t.innerText=String(globalDataBilly.postDate),e.appendChild(t),a.insertBefore(e,a.firstChild)}const i=document.querySelector(".addressee");if(document.body.contains(i)){let e=document.createElement("tr");const t=document.createElement("td");t.innerHTML=document.querySelector(".addressee").innerHTML.replace(/(<br\s*[\/]?>|<\/p>)/gi,", ").replace(/<\/?[^>]+(>|$)/g,"").replace(/,\s*$/,""),e.appendChild(t),a.insertBefore(e,a.firstChild)}Array.from(a.querySelectorAll("td")).forEach(e=>{e.innerHTML=e.innerHTML.replace(/(<br\s*[\/]?>|<\/p>)/gi,", ").replace(/<\/?[^>]+(>|$)/g,"").replace(/,\s*$/,"")});let c=XLSX.utils.table_to_book(a,{sheet:n.replace(/\W/g,"")});XLSX.writeFile(c,`${n}.${r}`)}}});