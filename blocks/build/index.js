(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,l=window.wp.blocks,a=window.wp.i18n,n=window.wp.blockEditor,r=window.wp.components,s=window.wp.serverSideRender;var i=e.n(s);(0,l.registerBlockType)("billy-blocks/header",{title:(0,a.__)("Header","billy"),icon:"editor-table",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,t.createElement)("a",{href:globalDataBilly.wpAdmin+"edit.php?post_type=wp_block"},(0,a.sprintf)((0,a.__)("Edit the %s layout","billy"),(0,a.__)("Header","billy"))))),(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("The %s values can be modified in the Theme Customizer.","billy"),(0,a.__)("Header","billy")))))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/header"}))),save:e=>null}),(0,l.registerBlockType)("billy-blocks/theme-mod",{title:(0,a.__)("Theme Mod","billy"),icon:"admin-generic",category:"billy-blocks",attributes:{themeMod:{type:"string",default:""}},supports:{inserter:!1,reusable:!1,html:!1},edit:e=>{const{className:l,attributes:{themeMod:s},setAttributes:c}=e;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Theme Mod","billy")},(0,t.createElement)(r.SelectControl,{label:(0,a.__)("Setting","billy"),help:(0,a.__)("Modify the value in the Theme Customizer.","billy"),options:globalDataBilly.themeModOptions,value:s,onChange:e=>{c({themeMod:e})}}))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/theme-mod",attributes:e.attributes})))},save:e=>null});const c=window.wp.data;(0,l.registerBlockType)("billy-blocks/invoice-actions",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Actions","billy")),icon:"menu-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)((e=>({postModifiedDate:e("core/editor").getEditedPostAttribute("modified")})))((e=>{const{postModifiedDate:l}=e;return(0,t.createElement)("div",{className:"components-placeholder",style:{minHeight:"auto"}},(0,t.createElement)("small",null,(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Last modified","billy"),new Date(l).toLocaleString())))})),save:e=>null}),(0,l.registerBlockType)("billy-blocks/invoice-meta",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Meta","billy")),icon:"editor-textcolor",category:"billy-blocks",attributes:{label:{type:"string",default:""},text:{type:"string",default:""}},supports:{inserter:!1,reusable:!1,html:!1},edit:e=>{const{className:l,attributes:{label:s,text:i},setAttributes:c}=e;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Label","billy")},(0,t.createElement)(r.TextControl,{type:"text",className:"label",value:s,onChange:e=>{c({label:e})}})),(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Text","billy")},(0,t.createElement)(r.TextControl,{type:"text",className:"text",value:i,onChange:e=>{c({text:e})}}))),(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)('<div class="label">%1$s</div> <div class="text">%2$s</div>',"billy"),s||"",i||(0,a.__)("N/A","billy"))))},save:e=>{const{className:l,attributes:{label:n,text:r}}=e;return r&&(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)('<div class="label">%1$s</div> <div class="text">%2$s</div>',"billy"),n||"",r||(0,a.__)("N/A","billy")))},deprecated:[{attributes:{label:{type:"string",default:""},text:{type:"string",default:""}},save:e=>{const{className:l,attributes:{label:n,text:r}}=e;return r&&(0,t.createElement)("p",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)("<p>"+(0,a.__)("<strong>%1$s</strong> <span>%2$s</span>","billy")+"</p>",n||"",r||(0,a.__)("N/A","billy"))))}}]}),(0,l.registerBlockType)("billy-blocks/invoice-date",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Date","billy")),icon:"calendar-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice is-warning"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("Due to legal requirements in some countries, autogenerated data like %s can't be modified anymore after an invoice has been created in the system!","billy"),(0,a.__)("Date","billy")))))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/invoice-date"}))),save:e=>null}),(0,l.registerBlockType)("billy-blocks/invoice-duedate",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Due Date","billy")),icon:"calendar-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("The %s values can be modified in the Theme Customizer.","billy"),(0,a.__)("Payment due days","billy")))))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/invoice-duedate"}))),save:e=>null}),(0,l.registerBlockType)("billy-blocks/invoice-number",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Number","billy")),icon:"editor-ol",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("The %s values can be modified in the Theme Customizer.","billy"),(0,a.__)("Invoice number: Prefix","billy")))),(0,t.createElement)("div",{className:"components-notice is-warning"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("Due to legal requirements in some countries, autogenerated data like %s can't be modified anymore after an invoice has been created in the system!","billy"),(0,a.__)("Invoice number","billy")))))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/invoice-number"}))),save:e=>null}),(0,l.registerBlockType)("billy-blocks/invoice-paymentinformation",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Payment Information","billy")),icon:"info",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("The %s values can be modified in the Theme Customizer.","billy"),(0,a.__)("Payment Information","billy")))))),(0,t.createElement)(r.Disabled,null,(0,t.createElement)(i(),{block:"billy-blocks/invoice-paymentinformation"}))),save:e=>null});const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e.toLocaleString(t,{minimumFractionDigits:2,maximumFractionDigits:2})},m=e=>parseFloat(e)/100,u=e=>(e=new Date(e)||new Date,[1,2,3,4][Math.floor(e.getMonth()/3)]),b=[{attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountSubtotal:{type:"number",default:""},amountTotal:{type:"number",default:""},taxRates:{type:"string",default:""},taxRatesTotal:{type:"number",default:""}},save:e=>{const{className:l,attributes:{currency:r,locale:s,amountSubtotal:i,amountTotal:c,taxRates:u,taxRatesTotal:b}}=e;return(0,t.createElement)("div",{className:"invoicetable-block alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Amount","billy")),u&&b>0&&(0,t.createElement)("th",{scope:"col"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,i>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{colSpan:"2",align:"right"},c>i?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s)))),u&&b>0&&(0,t.createElement)("tr",{className:"taxrates"},(0,t.createElement)("td",{colSpan:"2",align:"right"},(0,a.__)("Tax","billy")),(0,t.createElement)("td",null,JSON.parse(u).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),r,o(e.amount,s),"<small>("+e.taxRate+")</small><br>"))})))),c>i&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{colSpan:"2",align:"right"},(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))))))}}],d=[{attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},description:{type:"string",default:""},taxRate:{type:"string",default:""},amount:{type:"number",default:""},amountIncl:{type:"number",default:""},quantity:{type:"number",default:""},quantityRate:{type:"number",default:""}},save:e=>{const{className:l,attributes:{index:n,locale:r,description:s,taxRate:i,amount:c}}=e;return(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"row"},n&&n),(0,t.createElement)("td",null,s&&(0,t.createElement)(t.RawHTML,null,s)),(0,t.createElement)("td",null,c&&o(c,r)),i&&m(i)*c>0&&(0,t.createElement)("td",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),o(m(i)*c,r),"<small>("+i+")</small>"))))}}];(0,l.registerBlockType)("billy-blocks/invoice-table",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Table","billy")),icon:"menu-alt",category:"billy-blocks",attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountSubtotal:{type:"number",default:""},amountTotal:{type:"number",default:""},taxRates:{type:"string",default:""},taxRatesTotal:{type:"number",default:""}},supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlocksByClientId:a}=e("core/block-editor");return globalDataBilly.clientId=l,{childBlocks:null!==a(globalDataBilly.clientId)[0]?a(globalDataBilly.clientId)[0].innerBlocks:null}}))((e=>{const{className:l,childBlocks:r,attributes:{currency:s,locale:i,amountSubtotal:c,amountTotal:u,taxRates:b,taxRatesTotal:d},setAttributes:y}=e;y({currency:globalDataBilly.currency}),y({locale:globalDataBilly.locale});const p=()=>{var e=0,t=0,l=0,a=[],n=[];r&&r.length>0&&(r.map(((l,n)=>{e+=Number(l.attributes.amount),t+=Number(l.attributes.amount)+m(l.attributes.taxRate)*Number(l.attributes.amount),a.push({taxRate:l.attributes.taxRate,amount:m(l.attributes.taxRate)*Number(l.attributes.amount)})})),a.length>0&&(l=a.reduce((function(e,t){return e+t.amount}),0),l=Number(l.toFixed(2)),a.reduce((function(e,t){return e[t.taxRate]||(e[t.taxRate]={taxRate:t.taxRate,amount:0},n.push(e[t.taxRate])),e[t.taxRate].amount+=t.amount,e}),{})),y({taxRatesTotal:l}),y({taxRates:JSON.stringify(n)}),y({amountSubtotal:e}),y({amountTotal:t}))};return p(),(0,t.createElement)("div",{className:"invoicetable-block"+(l?" "+l:"")},(0,t.createElement)(n.InnerBlocks,{templateLock:!1,template:[["billy-blocks/invoice-tablerow",{}]],allowedBlocks:["billy-blocks/invoice-tablerow"]}),c>0&&(0,t.createElement)("table",{className:"totals"},(0,t.createElement)("tbody",null,c>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{style:{width:"50%"}},u>c?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),s,o(c,i)))),b&&d>0&&(0,t.createElement)("tr",{className:"taxRates"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Tax","billy")),(0,t.createElement)("td",null,JSON.parse(b).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),s,o(e.amount,i),"<small>("+e.taxRate+")</small><br>"))})))),u>c&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),s,o(u,i)))))),(0,t.createElement)("button",{id:"updatetotals",className:"components-button is-secondary is-button",onClick:p,style:{display:c>0?"block":"none"}},(0,a.__)("Update Totals","billy")))})),save:e=>{const{className:l,attributes:{currency:r,locale:s,amountSubtotal:i,amountTotal:c,taxRates:u,taxRatesTotal:b}}=e;return(0,t.createElement)("div",{className:"invoicetable-block alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Amount","billy")),u&&b>0&&(0,t.createElement)("th",{scope:"col"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,i>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},c>i?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s)))),u&&b>0&&(0,t.createElement)("tr",{className:"taxrates"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},(0,a.__)("Tax","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},JSON.parse(u).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),r,o(e.amount,s),"<small>("+e.taxRate+")</small><br>"))})))),c>i&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},(0,a.__)("Total","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))))))},deprecated:b}),(0,l.registerBlockType)("billy-blocks/invoice-tablerow",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Invoice","billy"),(0,a.__)("Table Row","billy")),icon:"menu-alt",category:"billy-blocks",parent:["billy-blocks/invoice-table"],attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},taxRate:{type:"string",default:""},amount:{type:"number",default:""},amountIncl:{type:"number",default:""},quantity:{type:"number",default:""},quantityRate:{type:"number",default:""}},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlockRootClientId:a,getBlockIndex:n}=e("core/block-editor");return{i:n(l,a(l))+1}}))((e=>{const{className:l,i:s,attributes:{index:i,currency:c,locale:o,description:u,taxRate:b,amount:d,amountIncl:y,quantity:p,quantityRate:_},setAttributes:E}=e;E({index:s}),E({currency:globalDataBilly.currency}),E({locale:globalDataBilly.locale}),""===b&&E({taxRate:0===globalDataBilly.taxOptions.length?"0%":globalDataBilly.taxOptions[0].value});const g=e=>{E({amountIncl:e>0?Number(e):""}),setTimeout((()=>{document.getElementById("updatetotals").click()}),1)},f=e=>{E({amount:e>0?Number(e):""}),g(Number(e)+Number(e)*m(b))};return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Quantity/Rate Calculator","billy")},(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.__)("Quantity","billy"),placeholder:(0,a.__)("0","billy"),value:p,onChange:e=>{E({quantity:e>0?Number(e):""}),f(Number(e)*Number(_))}}),(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Rate","billy"),c),placeholder:(0,a.__)("0","billy"),value:_,onChange:e=>{E({quantityRate:e>0?Number(e):""}),f(Number(p)*Number(e))}}))),(0,t.createElement)("table",null,(0,t.createElement)("tbody",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{className:"index"},i&&i),(0,t.createElement)("td",{style:{width:"30vw",minWidth:"200px"}},(0,t.createElement)(n.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,a.__)("Add content","billy"),content:u||""}]],allowedBlocks:["core/heading","core/paragraph","core/list","core/html"]})),(0,t.createElement)("td",null,(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Amount","billy"),c),className:"amount",placeholder:(0,a.__)("0","billy"),value:d,onChange:f})),(0,t.createElement)("td",null,(0,t.createElement)(r.SelectControl,{className:"taxrate",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Tax","billy"),"%"),value:b,options:0!==globalDataBilly.taxOptions.length?globalDataBilly.taxOptions:"0%"!==b&&0===globalDataBilly.taxOptions.length?[{label:b,value:b},{label:"0%",value:"0%"}]:"",onChange:e=>{E({taxRate:e}),g(Number(d)+Number(d)*m(e))}})),(0,t.createElement)("td",null,(0,t.createElement)(r.TextControl,{type:"number",disabled:"disabled",label:c,className:"amount-tax",placeholder:(0,a.__)("0","billy"),value:y}))))))})),save:e=>{const{className:l,attributes:{index:r,locale:s,taxRate:i,amount:c}}=e;return(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"row"},r&&r),(0,t.createElement)("td",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("td",null,c&&o(c,s)),i&&m(i)*c>0&&(0,t.createElement)("td",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),o(m(i)*c,s),"<small>("+i+")</small>"))))},deprecated:d}),(0,l.registerBlockType)("billy-blocks/quote-actions",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Actions","billy")),icon:"menu-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)((e=>({postModifiedDate:e("core/editor").getEditedPostAttribute("modified")})))((e=>{const{postModifiedDate:l}=e;return(0,t.createElement)("div",{className:"components-placeholder",style:{minHeight:"auto"}},(0,t.createElement)("small",null,(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Last modified","billy"),new Date(l).toLocaleString())))})),save:e=>null}),(0,l.registerBlockType)("billy-blocks/quote-meta",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Meta","billy")),icon:"editor-textcolor",category:"billy-blocks",attributes:{label:{type:"string",default:""},text:{type:"string",default:""}},supports:{inserter:!1,reusable:!1,html:!1},edit:e=>{const{className:l,attributes:{label:s,text:i},setAttributes:c}=e;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Label","billy")},(0,t.createElement)(r.TextControl,{type:"text",className:"label",value:s,onChange:e=>{c({label:e})}})),(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Text","billy")},(0,t.createElement)(r.TextControl,{type:"text",className:"text",value:i,onChange:e=>{c({text:e})}}))),(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)('<div class="label">%1$s</div> <div class="text">%2$s</div>',"billy"),s||"",i||(0,a.__)("N/A","billy"))))},save:e=>{const{className:l,attributes:{label:n,text:r}}=e;return r&&(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)('<div class="label">%1$s</div> <div class="text">%2$s</div>',"billy"),n||"",r||(0,a.__)("N/A","billy")))},deprecated:[{attributes:{label:{type:"string",default:""},text:{type:"string",default:""}},save:e=>{const{className:l,attributes:{label:n,text:r}}=e;return r&&(0,t.createElement)("p",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)("<p>"+(0,a.__)("<strong>%1$s</strong> <span>%2$s</span>","billy")+"</p>",n||"",r||(0,a.__)("N/A","billy"))))}}]}),(0,l.registerBlockType)("billy-blocks/quote-date",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Date","billy")),icon:"calendar-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(i(),{block:"billy-blocks/quote-date"}),save:e=>null}),(0,l.registerBlockType)("billy-blocks/quote-information",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Information","billy")),icon:"info",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Info","billy")},(0,t.createElement)("div",{className:"components-notice"},(0,t.createElement)("div",{className:"components-notice__content"},(0,a.sprintf)((0,a.__)("The %s values can be modified in the Theme Customizer.","billy"),(0,a.__)("Quote Information","billy")))))),(0,t.createElement)(i(),{block:"billy-blocks/quote-information"})),save:e=>null});const y=[{attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountSubtotal:{type:"number",default:""},amountTotal:{type:"number",default:""},taxRates:{type:"string",default:""},taxRatesTotal:{type:"number",default:""}},save:e=>{const{className:l,attributes:{currency:r,locale:s,amountSubtotal:i,amountTotal:c,taxRates:u,taxRatesTotal:b}}=e;return(0,t.createElement)("div",{className:"quotetable-block alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Amount","billy")),u&&b>0&&(0,t.createElement)("th",{scope:"col"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,i>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{colSpan:"2",align:"right"},c>i?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s)))),u&&b>0&&(0,t.createElement)("tr",{className:"taxrates"},(0,t.createElement)("td",{colSpan:"2",align:"right"},(0,a.__)("Tax","billy")),(0,t.createElement)("td",null,JSON.parse(u).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),r,o(e.amount,s),"<small>("+e.taxRate+")</small><br>"))})))),c>i&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{colSpan:"2",align:"right"},(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))))))}}],p=[{attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},description:{type:"string",default:""},taxRate:{type:"string",default:""},amount:{type:"number",default:""},amountIncl:{type:"number",default:""},quantity:{type:"number",default:""},quantityRate:{type:"number",default:""}},save:e=>{const{className:l,attributes:{index:n,locale:r,description:s,taxRate:i,amount:c}}=e;return(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"row"},n&&n),(0,t.createElement)("td",null,s&&(0,t.createElement)(t.RawHTML,null,s)),(0,t.createElement)("td",null,c&&o(c,r)),i&&m(i)*c>0&&(0,t.createElement)("td",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),o(m(i)*c,r),"<small>("+i+")</small>"))))}}];(0,l.registerBlockType)("billy-blocks/quote-table",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Table","billy")),icon:"menu-alt",category:"billy-blocks",attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountSubtotal:{type:"number",default:""},amountTotal:{type:"number",default:""},taxRates:{type:"string",default:""},taxRatesTotal:{type:"number",default:""}},supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlocksByClientId:a}=e("core/block-editor");return globalDataBilly.clientId=l,{childBlocks:null!==a(globalDataBilly.clientId)[0]?a(globalDataBilly.clientId)[0].innerBlocks:null}}))((e=>{const{className:l,childBlocks:r,attributes:{currency:s,locale:i,amountSubtotal:c,amountTotal:u,taxRates:b,taxRatesTotal:d},setAttributes:y}=e;y({currency:globalDataBilly.currency}),y({locale:globalDataBilly.locale});const p=()=>{var e=0,t=0,l=0,a=[],n=[];r&&r.length>0&&(r.map(((l,n)=>{e+=Number(l.attributes.amount),t+=Number(l.attributes.amount)+m(l.attributes.taxRate)*Number(l.attributes.amount),a.push({taxRate:l.attributes.taxRate,amount:m(l.attributes.taxRate)*Number(l.attributes.amount)})})),a.length>0&&(l=a.reduce((function(e,t){return e+t.amount}),0),l=Number(l.toFixed(2)),a.reduce((function(e,t){return e[t.taxRate]||(e[t.taxRate]={taxRate:t.taxRate,amount:0},n.push(e[t.taxRate])),e[t.taxRate].amount+=t.amount,e}),{})),y({taxRatesTotal:l}),y({taxRates:JSON.stringify(n)}),y({amountSubtotal:e}),y({amountTotal:t}))};return p(),(0,t.createElement)("div",{className:"quotetable-block"+(l?" "+l:"")},(0,t.createElement)(n.InnerBlocks,{templateLock:!1,template:[["billy-blocks/quote-tablerow",{}]],allowedBlocks:["billy-blocks/quote-tablerow"]}),c>0&&(0,t.createElement)("table",{className:"totals"},(0,t.createElement)("tbody",null,c>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{style:{width:"50%"}},u>c?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),s,o(c,i)))),b&&d>0&&(0,t.createElement)("tr",{className:"taxRates"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Tax","billy")),(0,t.createElement)("td",null,JSON.parse(b).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),s,o(e.amount,i),"<small>("+e.taxRate+")</small><br>"))})))),u>c&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Total","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),s,o(u,i)))))),(0,t.createElement)("button",{id:"updatetotals",className:"components-button is-secondary is-button",onClick:p,style:{display:c>0?"block":"none"}},(0,a.__)("Update Totals","billy")))})),save:e=>{const{className:l,attributes:{currency:r,locale:s,amountSubtotal:i,amountTotal:c,taxRates:u,taxRatesTotal:b}}=e;return(0,t.createElement)("div",{className:"quotetable-block alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col"},(0,a.__)("Amount","billy")),u&&b>0&&(0,t.createElement)("th",{scope:"col"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,i>0&&(0,t.createElement)("tr",{className:"subtotal"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},c>i?(0,a.__)("Subtotal","billy"):(0,a.__)("Total","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s)))),u&&b>0&&(0,t.createElement)("tr",{className:"taxrates"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},(0,a.__)("Tax","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},JSON.parse(u).sort(((e,t)=>m(e.taxRate)-m(t.taxRate))).map(((e,l)=>{if(e.amount>0)return(0,t.createElement)(t.RawHTML,{key:l},(0,a.sprintf)((0,a.__)("%1$s %2$s %3$s","billy"),r,o(e.amount,s),"<small>("+e.taxRate+")</small><br>"))})))),c>i&&(0,t.createElement)("tr",{className:"total"},(0,t.createElement)("td",{colSpan:"2",className:"align-right"},(0,a.__)("Total","billy")),(0,t.createElement)("td",{colSpan:u&&b>0?"2":null},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))))))},deprecated:y}),(0,l.registerBlockType)("billy-blocks/quote-tablerow",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Table Row","billy")),icon:"menu-alt",category:"billy-blocks",parent:["billy-blocks/quote-table"],attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},taxRate:{type:"string",default:""},amount:{type:"number",default:""},amountIncl:{type:"number",default:""},quantity:{type:"number",default:""},quantityRate:{type:"number",default:""}},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlockRootClientId:a,getBlockIndex:n}=e("core/block-editor");return{i:n(l,a(l))+1}}))((e=>{const{className:l,i:s,attributes:{index:i,currency:c,locale:o,description:u,taxRate:b,amount:d,amountIncl:y,quantity:p,quantityRate:_},setAttributes:E}=e;E({index:s}),E({currency:globalDataBilly.currency}),E({locale:globalDataBilly.locale}),""===b&&E({taxRate:0===globalDataBilly.taxOptions.length?"0%":globalDataBilly.taxOptions[0].value});const g=e=>{E({amountIncl:e>0?Number(e):""}),setTimeout((()=>{document.getElementById("updatetotals").click()}),1)},f=e=>{E({amount:e>0?Number(e):""}),g(Number(e)+Number(e)*m(b))};return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Quantity/Rate Calculator","billy")},(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.__)("Quantity","billy"),placeholder:(0,a.__)("0","billy"),value:p,onChange:e=>{E({quantity:e>0?Number(e):""}),f(Number(e)*Number(_))}}),(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Rate","billy"),c),placeholder:(0,a.__)("0","billy"),value:_,onChange:e=>{E({quantityRate:e>0?Number(e):""}),f(Number(p)*Number(e))}}))),(0,t.createElement)("table",null,(0,t.createElement)("tbody",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{className:"index"},i&&i),(0,t.createElement)("td",{style:{width:"30vw",minWidth:"200px"}},(0,t.createElement)(n.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,a.__)("Add content","billy"),content:u||""}]],allowedBlocks:["core/heading","core/paragraph","core/list","core/html"]})),(0,t.createElement)("td",null,(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Amount","billy"),c),className:"amount",placeholder:(0,a.__)("0","billy"),value:d,onChange:f})),(0,t.createElement)("td",null,(0,t.createElement)(r.SelectControl,{className:"taxrate",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Tax","billy"),"%"),value:b,options:0!==globalDataBilly.taxOptions.length?globalDataBilly.taxOptions:"0%"!==b&&0===globalDataBilly.taxOptions.length?[{label:b,value:b},{label:"0%",value:"0%"}]:"",onChange:e=>{E({taxRate:e}),g(Number(d)+Number(d)*m(e))}})),(0,t.createElement)("td",null,(0,t.createElement)(r.TextControl,{type:"number",disabled:"disabled",label:c,className:"amount-tax",placeholder:(0,a.__)("0","billy"),value:y}))))))})),save:e=>{const{className:l,attributes:{index:r,locale:s,taxRate:i,amount:c}}=e;return(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"row"},r&&r),(0,t.createElement)("td",null,(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("td",null,c&&o(c,s)),i&&m(i)*c>0&&(0,t.createElement)("td",null,(0,t.createElement)(t.RawHTML,null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),o(m(i)*c,s),"<small>("+i+")</small>"))))},deprecated:p}),(0,l.registerBlockType)("billy-blocks/quote-validuntildate",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Quote","billy"),(0,a.__)("Valid Until","billy")),icon:"calendar-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},edit:e=>(0,t.createElement)(i(),{block:"billy-blocks/quote-validuntildate"}),save:e=>null});const _=[{attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountTotalEarnings:{type:"number",default:""},amountTotalExpenses:{type:"number",default:""},amountTaxEarnings:{type:"number",default:""},amountTaxExpenses:{type:"number",default:""}},save:e=>{const{className:l,attributes:{currency:r,locale:s,amountTotalEarnings:i,amountTotalExpenses:c,amountTaxEarnings:m,amountTaxExpenses:u}}=e;return(0,t.createElement)("div",{className:"alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"index"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"date"},(0,a.__)("Date","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"description"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"reference"},(0,a.__)("Reference","billy")),(0,t.createElement)("th",{scope:"col",className:"sort earnings","data-sort":"earning"},(0,a.__)("Earnings","billy")),(0,t.createElement)("th",{scope:"col",className:"sort expenses","data-sort":"expense"},(0,a.__)("Expenses","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"tax"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",{className:"list"},(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.sprintf)((0,a.__)("%1$s / %2$s","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s))),(0,t.createElement)("td",{className:"sum expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))),(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.__)("Profit","billy")),(0,t.createElement)("td",{colSpan:"2",className:"profit"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i-c,s)))),(m>0||u>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.sprintf)((0,a.__)("%1$s (%2$s / %3$s)","billy"),(0,a.__)("Taxes","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum tax-earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(m,s))),(0,t.createElement)("td",{className:"sum tax-expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(u,s)))))))}},{attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountTotalEarnings:{type:"number",default:""},amountTotalExpenses:{type:"number",default:""},amountTaxEarnings:{type:"number",default:""},amountTaxExpenses:{type:"number",default:""}},save:e=>{const{className:l,attributes:{currency:r,locale:s,amountTotalEarnings:i,amountTotalExpenses:c,amountTaxEarnings:m,amountTaxExpenses:u}}=e;return(0,t.createElement)("div",{className:"alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"index"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"date"},(0,a.__)("Date","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"description"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"reference"},(0,a.__)("Reference","billy")),(0,t.createElement)("th",{scope:"col",className:"sort earnings","data-sort":"earning"},(0,a.__)("Earning","billy")),(0,t.createElement)("th",{scope:"col",className:"sort expenses","data-sort":"expense"},(0,a.__)("Expense","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"tax"},(0,a.__)("Tax","billy")))),(0,t.createElement)("tbody",{className:"list"},(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.sprintf)((0,a.__)("%1$s / %2$s","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s))),(0,t.createElement)("td",{className:"sum expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))),(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.__)("Profit","billy")),(0,t.createElement)("td",{colSpan:"2",className:"profit"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i-c,s)))),(m>0||u>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"4",align:"right"},(0,a.sprintf)((0,a.__)("%1$s (%2$s / %3$s)","billy"),(0,a.__)("Taxes","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum tax-earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(m,s))),(0,t.createElement)("td",{className:"sum tax-expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(u,s)))))))}}],E=[{attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},date:{type:"string",default:""},quarter:{type:"number",default:""},reference:{type:"string",default:""},description:{type:"string",default:""},earning:{type:"number",default:""},expense:{type:"number",default:""},tax:{type:"number",default:""},postUUID:{type:"string",default:""},postTitle:{type:"string",default:""},postLink:{type:"string",default:""},postType:{type:"string",default:""}},save:e=>{const{className:l,attributes:{index:n,locale:r,date:s,quarter:i,description:c,earning:m,expense:u,tax:b,reference:d,postLink:y}}=e;return(0,t.createElement)("tr",{"data-date":s&&new Date(s).toISOString().substring(0,10),"data-quarter":i&&(0,a.sprintf)((0,a.__)("Q%s","billy"),i),"data-reference":d&&d,"data-earning":m>0?m:null,"data-expense":u>0?u:null,"data-tax":b>0?b:null},(0,t.createElement)("th",{className:"index",scope:"row"},n&&n),(0,t.createElement)("td",{className:"date","data-value":s&&new Date(s).toISOString().substring(0,10)},s&&new Date(s).toISOString().substring(0,10),(0,t.createElement)("sub",null,i&&(0,a.sprintf)((0,a.__)("Q%s","billy"),i))),(0,t.createElement)("td",{className:"description"},c&&c),(0,t.createElement)("td",{className:"reference"},d&&!y&&d,d&&y&&(0,t.createElement)("a",{href:y},d)),(0,t.createElement)("td",{className:"amount earning","data-value":m>0?m:null},m&&m>0&&o(m,r)),(0,t.createElement)("td",{className:"amount expense","data-value":u>0?u:null},u&&u>0&&o(u,r)),(0,t.createElement)("td",{className:"amount tax","data-value":b>0?b:null},b&&b>0&&o(b,r)))}}];var g;(0,l.registerBlockType)("billy-blocks/accounting-table",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Accounting","billy"),(0,a.__)("Table","billy")),icon:"menu-alt",category:"billy-blocks",attributes:{currency:{type:"string",default:""},locale:{type:"string",default:""},amountTotalEarnings:{type:"number",default:""},amountTotalExpenses:{type:"number",default:""},amountTaxEarnings:{type:"number",default:""},amountTaxExpenses:{type:"number",default:""}},supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlocksByClientId:a}=e("core/block-editor");globalDataBilly.clientId=l;const n=a(l)[0].innerBlocks;return n.sort(((e,t)=>new Date(e.attributes.date)-new Date(t.attributes.date))),{childBlocks:n}}))((e=>{const{className:l,childBlocks:s,attributes:{currency:i,locale:c,amountTotalEarnings:m,amountTotalExpenses:u,amountTaxEarnings:b,amountTaxExpenses:d},setAttributes:y}=e;return y({currency:globalDataBilly.currency}),y({locale:globalDataBilly.locale}),(g=()=>{var e=0,t=0,l=0,a=0;s&&s.length>0&&s.forEach((n=>{e+=Number(n.attributes.earning),t+=Number(n.attributes.expense),n.attributes.earning&&(l+=Number(n.attributes.tax)),n.attributes.expense&&(a+=Number(n.attributes.tax))})),y({amountTotalEarnings:e}),y({amountTotalExpenses:t}),y({amountTaxEarnings:l}),y({amountTaxExpenses:a})})(),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Actions","billy")},(0,t.createElement)("button",{id:"updatetotals",className:"components-button is-secondary is-button",onClick:g},(0,a.__)("Update Totals","billy")))),(0,t.createElement)("div",{className:"accountingtable-block"+(l?" "+l:"")},(0,t.createElement)(n.InnerBlocks,{templateLock:!1,template:[["billy-blocks/accounting-tablerow",{}]],allowedBlocks:["billy-blocks/accounting-tablerow"]}),(0,t.createElement)("table",{className:"totals"},(0,t.createElement)("tbody",null,m>0&&(0,t.createElement)("tr",{className:"earnings"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Earnings","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),i,o(m,c)))),u>0&&(0,t.createElement)("tr",{className:"expenses"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Expenses","billy")),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),i,o(u,c)))),(m>0||u>0)&&(0,t.createElement)("tr",{className:"profit"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.__)("Profit","billy")),(0,t.createElement)("td",{style:{borderTop:"2px solid"}},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),i,o(m-u,c)))),(b>0||d>0)&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("tr",{className:"taxes-earnings"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.sprintf)((0,a.__)("Taxes (%s)","billy"),(0,a.__)("Earnings","billy"))),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),i,o(b,c)))),(0,t.createElement)("tr",{className:"taxes-expenses"},(0,t.createElement)("td",{style:{width:"50%"}},(0,a.sprintf)((0,a.__)("Taxes (%s)","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",null,(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),i,o(d,c)))))))))})),save:e=>{const{className:l,attributes:{currency:r,locale:s,amountTotalEarnings:i,amountTotalExpenses:c,amountTaxEarnings:m,amountTaxExpenses:u}}=e;return(0,t.createElement)("div",{className:"alignwide"+(l?" "+l:"")},(0,t.createElement)("table",{className:"table wp-block-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"index"},(0,a.__)("#","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"date"},(0,a.__)("Date","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"description"},(0,a.__)("Description","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"reference"},(0,a.__)("Reference","billy")),(0,t.createElement)("th",{scope:"col",className:"sort earnings","data-sort":"earning"},(0,a.__)("Earnings","billy")),(0,t.createElement)("th",{scope:"col",className:"sort expenses","data-sort":"expense"},(0,a.__)("Expenses","billy")),(0,t.createElement)("th",{scope:"col",className:"sort","data-sort":"tax"},(0,a.__)("Taxes","billy")))),(0,t.createElement)("tbody",{className:"list"},(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("tfoot",null,(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"5",className:"alignright"},(0,a.sprintf)((0,a.__)("%1$s / %2$s","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i,s))),(0,t.createElement)("td",{className:"sum expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(c,s)))),(i>0||c>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"5",className:"alignright"},(0,a.__)("Profit","billy")),(0,t.createElement)("td",{colSpan:"2",className:"profit"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(i-c,s)))),(m>0||u>0)&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"5",className:"alignright"},(0,a.sprintf)((0,a.__)("%1$s (%2$s / %3$s)","billy"),(0,a.__)("Taxes","billy"),(0,a.__)("Earnings","billy"),(0,a.__)("Expenses","billy"))),(0,t.createElement)("td",{className:"sum tax-earnings"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(m,s))),(0,t.createElement)("td",{className:"sum tax-expenses"},(0,a.sprintf)((0,a.__)("%1$s %2$s","billy"),r,o(u,s)))))))},deprecated:_}),(0,l.registerBlockType)("billy-blocks/accounting-tablerow",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Accounting","billy"),(0,a.__)("Table Row","billy")),icon:"menu-alt",category:"billy-blocks",parent:["billy-blocks/accounting-table"],attributes:{index:{type:"number",default:"0"},currency:{type:"string",default:""},locale:{type:"string",default:""},date:{type:"string",default:""},quarter:{type:"number",default:""},reference:{type:"string",default:""},earning:{type:"number",default:""},expense:{type:"number",default:""},tax:{type:"number",default:""},postUUID:{type:"string",default:""},postTitle:{type:"string",default:""},postLink:{type:"string",default:""},postType:{type:"string",default:""}},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)(((e,t)=>{let{clientId:l}=t;const{getBlockRootClientId:a,getBlockIndex:n}=e("core/block-editor");return{clientId:l,rootClientId:a(l),i:n(l,a(l))+1}}))((e=>{const{className:l,clientId:s,rootClientId:i,i:o,attributes:{index:m,currency:b,locale:d,description:y,date:p,quarter:_,earning:E,expense:f,tax:x,reference:h,postUUID:N,postTitle:T,postLink:$,postType:k},setAttributes:v}=e;return v({index:o}),v({currency:globalDataBilly.currency}),v({locale:globalDataBilly.locale}),""===p&&(v({date:(new Date).toISOString().substring(0,10)}),v({quarter:u((new Date).toISOString().substring(0,10))})),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,!N&&(0,t.createElement)(r.PanelBody,{title:(0,a.__)("Date","billy")},(0,t.createElement)(r.DatePicker,{currentDate:p,onChange:e=>{v({date:e}),(e=>{v({quarter:Number(u(e))})})(e),(0,c.dispatch)("core/block-editor").moveBlockToPosition(s,i,i,o)}})),N&&$&&(0,t.createElement)(r.PanelBody,{title:(0,a.sprintf)((0,a.__)("Reference: %s","billy"),k?k.charAt(0).toUpperCase()+k.substring(1):(0,a.__)("Post","billy"))},(0,t.createElement)("p",null,(0,t.createElement)("a",{href:$},T||$)))),(0,t.createElement)("table",null,(0,t.createElement)("tbody",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",{className:"index"},m&&m),(0,t.createElement)("td",{className:"date"},p&&new Date(p).toISOString().substring(0,10),(0,t.createElement)("sub",null,_&&(0,a.sprintf)((0,a.__)("Q%s","billy"),_))),(0,t.createElement)("td",{className:"description",style:{minWidth:"200px"}},(0,t.createElement)(n.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,a.__)("Add content","billy"),content:y||""}]],allowedBlocks:["core/heading","core/paragraph","core/list","core/html"]})),(0,t.createElement)("td",{className:"reference"},(0,t.createElement)(r.TextControl,{type:"text",label:(0,a.__)("Reference","billy"),placeholder:"",value:h,onChange:e=>{v({reference:e})}})),(0,t.createElement)("td",{className:"amount earning"},(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Earning","billy"),b),placeholder:(0,a.__)("0","billy"),value:E,onChange:e=>{v({expense:""}),v({earning:e>0?Number(e):""}),g()}})),(0,t.createElement)("td",{className:"amount expense"},(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Expense","billy"),b),placeholder:(0,a.__)("0","billy"),value:f,onChange:e=>{v({earning:""}),v({expense:e>0?Number(e):""}),g()}})),(0,t.createElement)("td",{className:"amount tax"},(0,t.createElement)(r.TextControl,{type:"number",label:(0,a.sprintf)((0,a.__)("%1$s in %2$s","billy"),(0,a.__)("Tax","billy"),b),placeholder:(0,a.__)("0","billy"),value:x,onChange:e=>{v({tax:e>0?Number(e):""}),g()}}))))))})),save:e=>{const{className:l,attributes:{index:r,locale:s,date:i,quarter:c,earning:m,expense:u,tax:b,reference:d,postLink:y}}=e;return(0,t.createElement)("tr",{"data-date":i&&new Date(i).toISOString().substring(0,10),"data-quarter":c&&(0,a.sprintf)((0,a.__)("Q%s","billy"),c),"data-reference":d&&d,"data-earning":m>0?m:null,"data-expense":u>0?u:null,"data-tax":b>0?b:null},(0,t.createElement)("th",{className:"index",scope:"row"},r&&r),(0,t.createElement)("td",{className:"date","data-value":i&&new Date(i).toISOString().substring(0,10)},i&&new Date(i).toISOString().substring(0,10),(0,t.createElement)("sub",null,c&&(0,a.sprintf)((0,a.__)("Q%s","billy"),c))),(0,t.createElement)("td",{className:"description"},(0,t.createElement)(n.InnerBlocks.Content,null)),(0,t.createElement)("td",{className:"reference"},d&&!y&&d,d&&y&&(0,t.createElement)("a",{href:y},d)),(0,t.createElement)("td",{className:"amount earning","data-value":m>0?m:null},m&&m>0&&o(m,s)),(0,t.createElement)("td",{className:"amount expense","data-value":u>0?u:null},u&&u>0&&o(u,s)),(0,t.createElement)("td",{className:"amount tax","data-value":b>0?b:null},b&&b>0&&o(b,s)))},deprecated:E}),(0,l.registerBlockType)("billy-blocks/accounting-actions",{title:(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Accounting","billy"),(0,a.__)("Actions","billy")),icon:"menu-alt",category:"billy-blocks",supports:{inserter:!1,reusable:!1,html:!1},getEditWrapperProps:()=>({"data-align":"wide"}),edit:(0,c.withSelect)((e=>({postModifiedDate:e("core/editor").getEditedPostAttribute("modified")})))((e=>{const{postModifiedDate:l}=e;return(0,t.createElement)("div",{className:"components-placeholder",style:{minHeight:"auto"}},(0,t.createElement)("small",null,(0,a.sprintf)((0,a.__)("%1$s: %2$s","billy"),(0,a.__)("Last modified","billy"),new Date(l).toLocaleString())))})),save:e=>null})})();